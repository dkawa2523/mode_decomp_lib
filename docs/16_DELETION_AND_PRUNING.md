# 削除・整理ポリシー（不要コード/不要ファイルを残さない）

本プロジェクトでは「使われないコードやファイルが溜まる」ことが、最大の保守コストになります。
各タスクで不要物を削除し、さらに定期的な“掃除タスク”で棚卸しを行います。

## 各Taskで必ずやること（必須）
- 実装中に作った一時コード/デバッグコードは**Task内で消す**
- 置き換えにより不要になった関数・分岐・ファイルは**Task内で削除**
- 削除に伴い以下も必ず更新：
  - import/参照
  - docs（読む順の更新、契約の変更があるならRFC）
  - tests（古い前提のテストを消す/更新）

## 削除の安全策
- “迷ったら残す” は原則禁止。
- ただし、削除が大きく危険な場合は次のいずれか：
  1) 先に `work/rfcs/` で合意（大規模削除）
  2) `deprecated` として明示し、**削除期限をタスク化**して残す（放置しない）

## 削除時のチェックリスト
- [ ] `ripgrep` / `git grep` で参照が残っていない
- [ ] `python -m compileall` が通る
- [ ] `pytest`（または smoke）でE2Eが通る
- [ ] artifact/metrics 形式に影響がある場合は docs を更新

## “掃除タスク” の位置づけ
- 各タスクの削除とは別に、定期的に **未使用ファイル/ディレクトリを棚卸しして削除するタスク** を起票する（work/queue に追加）。

## ローカル生成物の整理ユーティリティ
リポジトリ内の生成物は `tools/cleanup_artifacts.py` で整理できる。
- 既定は dry-run。削除する場合は `--apply` を付ける。
- 必要なら `--include-venv` で `.venv*` を削除できる。

### 推奨運用（頻度/対象）
- **頻度**: 週次または大きな実験後に1回（CI/共有環境では自動化推奨）
- **対象**:
  - 常時: `runs/`, `outputs/`, `work/.autopilot`, `work/_logs`, `.pytest_cache`, `__pycache__`
  - 必要時のみ: `.venv*`（環境を捨てる場合のみ `--include-venv`）
