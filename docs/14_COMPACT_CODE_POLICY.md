# コンパクト実装ポリシー（コード量を増やさないための不変指針）

このドキュメントは「開発が進むほどコードが膨らみ、読みづらくなる」事故を防ぐための不変ポリシーです。
**目的仕様（docs/00, 01, 02, 10）を最優先**しつつ、可能な限りコンパクトに実装してください。

## 原則（必須）
1. **追加より削除を優先**
   - 既存の処理や一般的ライブラリで代替できるなら新規実装しない。
   - 使われなくなった分岐・関数・ファイルは削除する（docs/16 参照）。
2. **“今必要な抽象化” だけ**
   - 将来の可能性のための過剰な抽象化をしない（YAGNI）。
   - ただし「差し替え点（decompose / coeff_post / model / dataset / process）」はプラグイン契約で確保する（docs/11）。
3. **小さく繋ぐ**
   - 1ファイルが巨大にならないよう、責務で分ける。
   - ただし分割しすぎて追跡不能にならないよう、**入口（pipeline/process）→ plugin → util** の導線を維持。
4. **設定が真実**
   - 仕様差分は config で切替える。コード内ハードコードを増やさない（docs/03）。
5. **デバッグコードを残さない**
   - print/debug用の枝・一時ファイル生成・未使用変数は最終コミット前に削除。
   - 必要な観測点は logger に統一して残す（artifact/metricsに繋ぐ）。

## 推奨ルール（できるだけ守る）
- 「最小の公開API」を保ち、内部の細部は隠す（外部に呼ばれる関数を増やしすぎない）。
- 同じ処理を2回書かない（共通化は“繰り返しが2回を超えたら”）。
- “便利関数集” を増やしすぎない（utils は目的別に最小限）。
- 依存を増やす前に、標準ライブラリ / numpy / scipy / sklearn で済むか検討。

## 完了判定に含める（各Task共通）
- 実装した機能が動くことに加えて、**不要コードが残っていない**こと。
- 「増えた行数」に対し、「消した行数」が不自然に少ない場合は要レビュー。
